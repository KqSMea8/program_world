  1ã€canal.properties (${canal.root}/conf)

## å½“å‰canalèŠ‚ç‚¹éƒ¨ç½²çš„instancesåˆ—è¡¨ï¼Œä»¥â€œ,â€åˆ†å‰²
##æ¯”å¦‚ï¼štest,example
canal.destinations= example
##canalé…ç½®æ–‡ä»¶ä¸»ç›®å½•ï¼Œä¿æŒé»˜è®¤å³å¯ã€‚
##é™¤éä½ ä¸ºäº†æé«˜canalçš„åŠ¨æ€ç®¡ç†èƒ½åŠ›ï¼Œå°†confæ–‡ä»¶è¿ç§»åˆ°äº†å…¶ä»–ç›®å½•ï¼ˆæ¯”å¦‚NFSç›®å½•ç­‰ï¼‰
canal.conf.dir = ../conf
# æ˜¯å¦å¼€å¯â€œinstanceâ€é…ç½®ä¿®æ”¹è‡ªåŠ¨æ‰«æå’Œé‡è½½
##1ï¼‰conf.dirç›®å½•ä¸‹æ–°å¢ã€åˆ é™¤instanceé…ç½®ç›®å½•
##2ï¼‰instanceé…ç½®ç›®å½•ä¸‹çš„instance.propertieså˜æ›´
##ä¸åŒ…å«ï¼šcanal.propertiesï¼Œspring/*.xmlçš„é…ç½®å˜æ›´
##å¦‚æœç¯å¢ƒéš”ç¦»ã€æµ‹è¯•å……åˆ†çš„ç¯å¢ƒä¸‹ï¼Œæˆ–è€…åº”ç”¨è¯•ç”¨åˆæœŸï¼Œå¯ä»¥å¼€å¯
##å¯¹äºé«˜é£é™©é¡¹ç›®ï¼Œå»ºè®®å…³é—­ã€‚
canal.auto.scan = true
canal.auto.scan.interval = 5


##instanceç®¡ç†æ¨¡å¼ï¼ŒProductionçº§åˆ«æˆ‘ä»¬è¦æ±‚ä½¿ç”¨spring
canal.instance.global.mode = spring
##ç›´æ¥åˆå§‹åŒ–å’Œå¯åŠ¨instance
canal.instance.global.lazy = false
##Productionçº§åˆ«ï¼ŒHAæ¨¡å¼ä¸‹ï¼ŒåŸºäºdefault-instance.xml
##éœ€è¦å³å¤‡çš„ZKé›†ç¾¤ï¼Œä¸”ä¸åº”è¯¥ä¿®æ”¹æ­¤æ–‡ä»¶çš„é»˜è®¤é…ç½®ã€‚
##å¦‚æœæœ‰è‡ªå®šä¹‰çš„åœºæ™¯ï¼Œåº”è¯¥æ–°å»º${instance}-instance.xmlæ–‡ä»¶
canal.instance.global.spring.xml = classpath:spring/default-instance.xml



##canal serverçš„å”¯ä¸€æ ‡è¯†ï¼Œæ²¡æœ‰å®é™…æ„ä¹‰ï¼Œä½†æ˜¯æˆ‘ä»¬å»ºè®®åŒä¸€ä¸ªclusterä¸Šçš„ä¸åŒèŠ‚ç‚¹ï¼Œå…¶IDå°½å¯èƒ½å”¯ä¸€ï¼ˆåç»­å‡çº§ï¼‰
##æ•°å­—ç±»å‹
canal.id = 1
##canal serverå› ä¸ºbindingçš„æœ¬åœ°IPåœ°å€ï¼Œå»ºè®®ä½¿ç”¨å†…ç½‘ï¼ˆå”¯ä¸€ï¼Œé›†ç¾¤å¯è§ï¼Œconsumerå¯è§ï¼‰IPåœ°å€ï¼Œæ¯”å¦‚â€œ10.0.1.21â€ã€‚
#æ­¤IPä¸»è¦ä¸ºcanalServeræä¾›TCPæœåŠ¡è€Œä½¿ç”¨ï¼Œå°†ä¼šè¢«æ³¨å†Œåˆ°ZKä¸­,Consumerå°†ä¸æ­¤IPå»ºç«‹è¿æ¥ã€‚
canal.ip =
##conal serverçš„TCPç«¯å£
canal.port = 11111
##Productionåœºæ™¯ï¼ŒHAæ¨¡å¼ä¸‹ï¼Œæ¯”å¦‚ä½¿ç”¨ZKä½œä¸ºæœåŠ¡ç®¡ç†ï¼Œæ­¤å¤„è‡³å°‘æŒ‡å®šâ€œå¤šæ•°æ´¾ZK Nodeâ€çš„IPåˆ—è¡¨
##å¦‚æœä½ çš„å¤šä¸ªCanal Clusterå…±äº«ZKï¼Œé‚£ä¹ˆæ¯ä¸ªCanalè¿˜éœ€è¦ä½¿ç”¨å”¯ä¸€çš„â€œrootpathâ€ã€‚
canal.zkServers = 10.0.1.21:2818,10.0.1.22,10.0.2.21:2818/canal/g1
# flush data to zk
##é€‚ç”¨äºmetaManagerï¼ŒåŸºäºperiodæ¨¡å¼
##metaManagerä¼˜å…ˆå°†æ•°æ®ï¼ˆpositionï¼‰ä¿å­˜åœ¨å†…å­˜ï¼Œç„¶åå®šæ—¶ã€é—´æ­‡æ€§çš„å°†æ•°æ®åŒæ­¥åˆ°ZKä¸­ã€‚
##æ­¤å‚æ•°ç”¨äºæ§åˆ¶åŒæ­¥çš„æ—¶é—´é—´éš”ï¼Œå»ºè®®ä¸ºâ€œ1000â€ï¼ˆ1Sï¼‰ï¼Œå•ä½ï¼šmsã€‚
##è¿ç»´æˆ–è€…æ¶æ„å¸ˆï¼Œåº”è¯¥è§‚å¯ŸZKçš„æ•ˆèƒ½ï¼Œå¦‚æœTPSè¿‡äºé¢‘ç¹ï¼Œå¯ä»¥æé«˜æ­¤å€¼ã€æˆ–è€…æŒ‰Canalé›†ç¾¤åˆ†ç¦»ZKé›†ç¾¤ã€‚
##ç›®å‰æ¶æ„ä¸‹ï¼ŒConsumerå‘CanalServeræäº¤ACKæ—¶ä¼šå¯¼è‡´ZKæ•°æ®çš„åŒæ­¥ã€‚
canal.zookeeper.flush.period = 1000
##canalå°†parseã€positionæ•°æ®å†™å…¥çš„æœ¬åœ°æ–‡ä»¶ç›®å½•ï¼ŒHAç¯å¢ƒä¸‹æ— æ•ˆã€‚
##ï¼ˆfile-instance.xmlï¼‰
canal.file.data.dir = ${canal.conf.dir}
canal.file.flush.period = 1000
##å†…å­˜æ¨¡å¼ï¼ŒEventStoreä¸ºMemoryç±»å‹æ—¶ã€‚ï¼ˆdefault-instance.xmlï¼‰
##å¯é€‰å€¼ï¼š
##1) MEMSIZE   æ ¹æ®buffer.size * buffer.memunitçš„å¤§å°ï¼Œé™åˆ¶ç¼“å­˜è®°å½•çš„å¤§å°ï¼Œç®€ç­”æ¥è¯´ï¼Œå°±æ˜¯å†…å­˜å®¹é‡å¤§å°é™åˆ¶
##2) ITEMSIZE   æ ¹æ®buffer.sizeè¿›è¡Œé™åˆ¶ï¼Œç®€å•æ¥è¯´ï¼Œå°±æ˜¯æ ¹æ®eventçš„æ¡æ•°é™åˆ¶ã€‚
##å¦‚æœCanalä¸Šçš„instancesä¸ªæ•°æœ‰é™ï¼Œä¸”Consumerçš„æ¶ˆè´¹æ•ˆç‡å¾ˆé«˜ï¼Œç”šè‡³æ¥è¿‘æˆ–è€…é«˜äºbinlogè§£ææ•ˆç‡ï¼Œé‚£ä¹ˆå¯ä»¥é€‚åº¦å¢åŠ memoryæœ‰å…³çš„æ•°å€¼ã€‚
##æ­¤å¤–batchModeè¿˜ä¸æ¶ˆè´¹è€…çš„batchSizeæœ‰äº›å…³ç³»ï¼Œæ¶ˆè´¹è€…æ¯æ¬¡èƒ½æ¶ˆè´¹çš„æ•°æ®é‡ï¼Œå–å†³äºæ­¤modeã€‚
##å¦‚æœmodeä¸ºitemSizeï¼Œåˆ™consumeræ¯æ¬¡è·å–çš„æ¶ˆæ¯çš„æ¡æ•°ä¸ºbatchSizeæ¡ã€‚
##å¦‚æœmodeä¸ºmemSizeï¼Œé‚£ä¹ˆconsumeræ¶ˆè´¹çš„æ•°æ®æ€»é‡ä¸ºbatchSize * memunit
canal.instance.memory.batch.mode = MEMSIZE
canal.instance.memory.buffer.size = 16384
canal.instance.memory.buffer.memunit = 1024


# æ‰€èƒ½æ”¯æ’‘çš„äº‹åŠ¡çš„æœ€å¤§é•¿åº¦ï¼Œè¶…è¿‡é˜ˆå€¼ä¹‹åï¼Œä¸€ä¸ªäº‹åŠ¡çš„æ¶ˆæ¯å°†ä¼šè¢«æ‹†åˆ†ï¼Œå¹¶å¤šæ¬¡æäº¤åˆ°eventStoreä¸­ï¼Œä½†æ˜¯å°†æ— æ³•ä¿è¯äº‹åŠ¡çš„å®Œæ•´æ€§
canal.instance.transaction.size =  1024
# å½“instance.propertiesé…ç½®æ–‡ä»¶ä¸­æŒ‡å®šâ€œmasterâ€ã€â€œstandbyâ€æ—¶ï¼Œå½“canalä¸â€œmasterâ€è”é€šæ€§æ•…éšœæ—¶ï¼Œè§¦å‘è¿æ¥æºçš„åˆ‡æ¢ï¼Œ
##é‚£ä¹ˆåˆ‡æ¢æ—¶ï¼Œåœ¨æ–°çš„mysqlåº“ä¸ŠæŸ¥æ‰¾binlogæ—¶éœ€è¦å¾€å‰â€œå›é€€â€æŸ¥æ‰¾çš„æ—¶é—´ï¼Œå•ä½ï¼šç§’ã€‚
##è‰¯å¥½æ¶æ„ä¸‹ï¼Œæˆ‘ä»¬å»ºè®®ä¸ä½¿ç”¨â€œstandbyâ€ï¼Œé™å®šä¸€ä¸ªæ•°æ®åº“æºã€‚å› ä¸ºå¤šä¸ªæºæ—¶ï¼Œæ•°æ®åº“çš„è°ƒæ•´é¢‘ç¹ã€åè°ƒä¸è¶³ï¼Œå¯èƒ½ä¼šå¼•å…¥ä¸€äº›æ•°æ®é—®é¢˜ã€‚
canal.instance.fallbackIntervalInSeconds = 60


## æœ‰å…³HAå¿ƒè·³æ£€æµ‹éƒ¨åˆ†ï¼Œä¸»è¦ç”¨åœ¨Parserç®¡ç†dumpè¿æ¥æ—¶ä½¿ç”¨ã€‚
## æˆ‘ä»¬åœ¨HAç¯å¢ƒæ—¶å»ºè®®å¼€å¯ã€‚
canal.instance.detecting.enable = true
#å¦‚æœä½ éœ€è¦é™å®šæŸä¸ªdatabaseçš„å¯ç”¨æ€§éªŒè¯ï¼ˆæ¯”å¦‚åº“é”ï¼‰ï¼Œ
#æœ€å¥½ä½¿ç”¨å¤æ‚çš„ã€æœ‰æ•ˆçš„SQLï¼Œæ¯”å¦‚ï¼šinsert into {database}.{tmpTable} ....
canal.instance.detecting.sql = select 1
##å¿ƒè·³æ£€æµ‹é¢‘ç‡ï¼Œå•ä½ç§’
canal.instance.detecting.interval.time = 6
##é‡è¯•æ¬¡æ•°
##éå¸¸æ³¨æ„ï¼šinterval.time * retry.thresholdå€¼ï¼Œåº”è¯¥å‚è€ƒæ—¢å¾€DBAåŒå­¦å¯¹æ•°æ®åº“çš„æ•…éšœæ¢å¤æ—¶é—´ï¼Œ
##â€œå¤ªçŸ­â€ä¼šå¯¼è‡´é›†ç¾¤è¿è¡Œæ€è§’è‰²â€œå¤šè·³â€ï¼›â€œå¤ªé•¿â€å¤±å»äº†æ´»æ€§æ£€æµ‹çš„æ„ä¹‰ï¼Œå¯¼è‡´é›†ç¾¤çš„æ•æ„Ÿåº¦é™ä½ï¼ŒConsumeræ–­è·¯å¯èƒ½æ€§å¢åŠ ã€‚
canal.instance.detecting.retry.threshold = 5
#å¦‚æœåœ¨instance.propertiesé…ç½®äº†â€œmasterâ€ã€â€œstandbyâ€ï¼Œä¸”æ­¤å‚æ•°å¼€å¯æ—¶ï¼Œåœ¨â€œæ¢æµ‹å¤±è´¥â€åï¼Œä¼šé€‰æ‹©å¤‡åº“è¿›è¡Œbinlogè·å–
#å»ºè®®å…³é—­
canal.instance.detecting.heartbeatHaEnable = false


# CanalServerã€instanceæœ‰å…³çš„TCPç½‘ç»œé…ç½®ï¼Œå»ºè®®ä¿æŒæŠ±äºº
canal.instance.network.receiveBufferSize = 16384
canal.instance.network.sendBufferSize = 16384
canal.instance.network.soTimeout = 30

# Parserç»„ä»¶ï¼Œæœ‰å…³binlogè§£æçš„è¿‡æ»¤
##æ˜¯å¦è¿‡æ»¤dclè¯­å¥ï¼Œæ¯”å¦‚â€œgrant/create userâ€ç­‰
canal.instance.filter.query.dcl = false
##dmlè¯­å¥ï¼šinsert/update/deleteç­‰
canal.instance.filter.query.dml = false
##ddlè¯­å¥ï¼šcreate table/alter table/drop tableä»¥åŠä¸€äº›indexå˜æ›´
canal.instance.filter.query.ddl = false
canal.instance.filter.table.error = false
canal.instance.filter.rows = false


# binlogæ ¼å¼å’Œâ€œé•œåƒâ€æ ¼å¼æ£€æµ‹ï¼Œå»ºè®®ä¿æŒé»˜è®¤
canal.instance.binlog.format = ROW,STATEMENT,MIXED
canal.instance.binlog.image = FULL,MINIMAL,NOBLOB


# ddlæ˜¯å¦éš”ç¦»å‘é€ï¼Œä¿æŒé»˜è®¤
canal.instance.get.ddl.isolation = false


    canal.propertiesä¸ºå…¨å±€é…ç½®ï¼Œçº¦æŸæ‰€æœ‰çš„instancesã€CanalServerç­‰ã€‚
    2ã€instance.properties ï¼ˆ${canal.root}/conf/{instance}ï¼‰

## æ¯ä¸ªinstanceéƒ½ä¼šä¼ªè£…æˆä¸€ä¸ªmysql slaveï¼Œ
## è€ƒè™‘åˆ°binlogåŒæ­¥çš„æœºåˆ¶ï¼Œæˆ‘ä»¬éœ€è¦æŒ‡å®šslaveIdï¼Œæ³¨æ„æ­¤IDå¯¹äºæ­¤canalå‰ç«¯çš„MySQLå®ä¾‹è€Œè¨€ï¼Œå¿…é¡»æ˜¯å”¯ä¸€çš„ã€‚
##  åŒä¸€ä¸ªCanal clusterä¸­ç›¸åŒinstanceï¼Œæ­¤slaveIdåº”è¯¥ä¸€æ ·ã€‚
##  æˆ‘ä»¬çº¦å®šï¼Œæ‰€æœ‰Canalçš„instanceï¼Œå…¶slaveIdä»¥â€œ1111â€å¼€å¤´ï¼Œåé¢è¡¥å……å››ä½æ•°å­—ã€‚
canal.instance.mysql.slaveId = 11110001

# æ•°æ®åº“ç›¸å…³ï¼šmasteråº“
##å¤‡æ³¨ï¼Œmasterå¹¶ä¸æ˜¯è¦æ±‚æ˜¯â€œMySQL æ•°æ®åº“Masterâ€ï¼Œ
## è€Œæ˜¯Canal instanceé›†ç¾¤æ¨¡å¼ä¸‹ï¼ŒHAè¿è¡Œæ€ä¸­â€œmasterâ€ï¼ˆé¦–é€‰èŠ‚ç‚¹ï¼‰
## å½“åœ¨æ•…éšœæ¢å¤ã€Canalè¿ç§»æ—¶ï¼Œæˆ‘ä»¬éœ€è¦æ‰‹åŠ¨æŒ‡å®šbinlogåç§°ä»¥åŠpostitionæˆ–è€…timestampï¼Œç¡®ä¿æ–°Canalä¸ä¼šä¸¢å¤±æ•°æ®ã€‚
## æ•°æ®åº“å®ä¾‹åœ°å€ï¼Œip:port
canal.instance.master.address = 127.0.0.1:3306
##æŒ‡å®šèµ·å§‹çš„binlogæ–‡ä»¶åï¼Œä¿æŒé»˜è®¤
canal.instance.master.journal.name =
##æ­¤binlogæ–‡ä»¶çš„positionä½ç½®ï¼ˆoffsetï¼‰ï¼Œæ•°å­—ç±»å‹ã€‚è·å–æ­¤positionä¹‹åçš„æ•°æ®ã€‚
canal.instance.master.position =
##æ­¤binlogçš„èµ·å§‹æ—¶é—´æˆ³ï¼Œè·å–æ­¤timestampä¹‹åçš„æ•°æ®ã€‚
canal.instance.master.timestamp =

##standbyåº“
##è€ƒè™‘åˆ°æˆ‘å¸ç°çŠ¶ï¼Œæš‚ä¸ä½¿ç”¨standby
#canal.instance.standby.address =
#canal.instance.standby.journal.name =
#canal.instance.standby.position =
#canal.instance.standby.timestamp =

# æ•°æ®åº“è¿æ¥çš„ç”¨æˆ·åå’Œå¯†ç 
# è²Œä¼¼Consumerä¸CanalServerå»ºç«‹è¿æ¥æ—¶ä¹Ÿç”¨çš„æ˜¯æ­¤ç”¨æˆ·åå’Œå¯†ç 
canal.instance.dbUsername = canal
canal.instance.dbPassword = canal
# é»˜è®¤æ•°æ®åº“
canal.instance.defaultDatabaseName =
canal.instance.connectionCharset = UTF-8

# schemaè¿‡æ»¤è§„åˆ™ï¼Œç±»ä¼¼äºMySQL binlogçš„filter
# canalå°†ä¼šè¿‡æ»¤é‚£äº›ä¸ç¬¦åˆè¦æ±‚çš„tableï¼Œè¿™äº›tableçš„æ•°æ®å°†ä¸ä¼šè¢«è§£æå’Œä¼ é€
# filteræ ¼å¼ï¼ŒConsumerç«¯å¯ä»¥æŒ‡å®šï¼Œåªä¸è¿‡æ˜¯åç½®çš„ã€‚
## æ— è®ºæ˜¯CanalServerè¿˜æ˜¯Consumerï¼Œåªè¦æœ‰ä¸€æ–¹æŒ‡å®šäº†filteréƒ½ä¼šç”Ÿæ•ˆï¼Œconsumerç«¯å¦‚æœæŒ‡å®šï¼Œåˆ™ä¼šè¦†ç›–CanalServerç«¯ã€‚
canal.instance.filter.regex = .*\\..*
# table black regex
canal.instance.filter.black.regex =

    3ã€default-instance.xml ï¼ˆ${canal.root}/conf/springï¼‰


    å®‰è£…canal
    ä¸‹è½½å®‰è£…åŒ…ï¼š
    https://github.com/alibaba/canal/releases
    canal.kafka-1.1.0.tar.gz

    è§£å‹åˆ°å›ºå®šç›®å½•ï¼š

    tar -zxvf canal.kafka-1.1.0.tar.gz
    1
    ä¿®æ”¹é…ç½®

    vi conf/example/instance.properties

    #æ•°æ®åº“åœ°å€
    canal.instance.master.address=192.168.56.104:3306

    #æ•°æ®åº“ç”¨æˆ·å¯†ç 
    canal.instance.dbUsername = canal
    canal.instance.dbPassword = canal

    #æ•°æ®åº“å­—ç¬¦é›†
    canal.instance.connectionCharset=UTF-8

    #é»˜è®¤æ•°æ®åº“
    canal.instance.defaultDatabaseName =zgai_db

    1
    2
    3
    4
    5
    6
    7
    8
    9
    10
    11
    12
    13
    vim /usr/local/canal/conf/canal.properties

    #canalid
    canal.id= 1

    #canalåœ°å€
    canal.ip=192.168.56.102

    #zookeeperåœ°å€
    canal.zkServers=192.168.56.102:2181

    1
    2
    3
    4
    5
    6
    7
    8
    9
    vim /usr/local/canal/conf/kafka.yml

    #kafkaåœ°å€
    servers: 192.168.56.101:9092

    # canalçš„æ‰¹æ¬¡å¤§å°ï¼Œå•ä½ k
    canalBatchSize: 50

    #topic
        topic: mytopic
    1
    2
    3
    4
    5
    6
    7
    8
    é…ç½®è¯¦ç»†ä»‹ç»
    canal.properties
    canalé…ç½®ä¸»è¦åˆ†ä¸ºä¸¤éƒ¨åˆ†å®šä¹‰ï¼š

    instanceåˆ—è¡¨å®šä¹‰ (åˆ—å‡ºå½“å‰serverä¸Šæœ‰å¤šå°‘ä¸ªinstanceï¼Œæ¯ä¸ªinstanceçš„åŠ è½½æ–¹å¼æ˜¯spring/managerç­‰)
    |å‚æ•°åå­—	|å‚æ•°è¯´æ˜	|é»˜è®¤å€¼|
    | ------------- |:-------------ğŸ˜ -----ğŸ˜
    |canal.destinations|	å½“å‰serverä¸Šéƒ¨ç½²çš„instanceåˆ—è¡¨|	æ— 
    |canal.conf.dir|	conf/ç›®å½•æ‰€åœ¨çš„è·¯å¾„	|â€¦/conf
    |canal.auto.scan|	å¼€å¯instanceè‡ªåŠ¨æ‰«æå¦‚æœé…ç½®ä¸ºtrueï¼Œcanal.conf.dirç›®å½•ä¸‹çš„instanceé…ç½®å˜åŒ–ä¼šè‡ªåŠ¨è§¦å‘ï¼ša. instanceç›®å½•æ–°å¢ï¼š è§¦å‘instanceé…ç½®è½½å…¥ï¼Œlazyä¸ºtrueæ—¶åˆ™è‡ªåŠ¨å¯åŠ¨b. instanceç›®å½•åˆ é™¤ï¼šå¸è½½å¯¹åº”instanceé…ç½®ï¼Œå¦‚å·²å¯åŠ¨åˆ™è¿›è¡Œå…³é—­c. instance.propertiesæ–‡ä»¶å˜åŒ–ï¼šreload instanceé…ç½®ï¼Œå¦‚å·²å¯åŠ¨è‡ªåŠ¨è¿›è¡Œé‡å¯æ“ä½œ | true
    |canal.auto.scan.interval	|instanceè‡ªåŠ¨æ‰«æçš„é—´éš”æ—¶é—´ï¼Œå•ä½ç§’|	5
    |canal.instance.global.mode|	å…¨å±€é…ç½®åŠ è½½æ–¹å¼	|spring
    |canal.instance.global.lazy|	å…¨å±€lazyæ¨¡å¼	|false
    |canal.instance.global.manager.address|	å…¨å±€çš„manageré…ç½®æ–¹å¼çš„é“¾æ¥ä¿¡æ¯|	æ— 
    |canal.instance.global.spring.xml|	å…¨å±€çš„springé…ç½®æ–¹å¼çš„ç»„ä»¶æ–‡ä»¶	|classpath:spring/memory-instance.xml (springç›®å½•ç›¸å¯¹äºcanal.conf.dir)
    |canal.instance.example.mode canal.instance.example.lazy canal.instance.example.spring.xmlâ€¦	| instanceçº§åˆ«çš„é…ç½®å®šä¹‰ï¼Œå¦‚æœ‰é…ç½®ï¼Œä¼šè‡ªåŠ¨è¦†ç›–å…¨å±€é…ç½®å®šä¹‰æ¨¡å¼å‘½åè§„åˆ™ï¼šcanal.instance.{name}.xxx	|æ— 
    |canal.instance.tsdb.spring.xml|	v1.0.25ç‰ˆæœ¬æ–°å¢,å…¨å±€çš„tsdbé…ç½®æ–¹å¼çš„ç»„ä»¶æ–‡ä»¶	|classpath:spring/tsdb/h2-tsdb.xml (springç›®å½•ç›¸å¯¹äºcanal.conf.dir)

    commonå‚æ•°å®šä¹‰ï¼Œæ¯”å¦‚å¯ä»¥å°†instance.propertiesçš„å…¬ç”¨å‚æ•°ï¼ŒæŠ½å–æ”¾ç½®åˆ°è¿™é‡Œï¼Œè¿™æ ·æ¯ä¸ªinstanceå¯åŠ¨çš„æ—¶å€™å°±å¯ä»¥å…±äº«. ã€instance.propertiesé…ç½®å®šä¹‰ä¼˜å…ˆçº§é«˜äºcanal.propertiesã€‘

    å‚æ•°åå­—	å‚æ•°è¯´æ˜	é»˜è®¤å€¼
    canal.id	æ¯ä¸ªcanal serverå®ä¾‹çš„å”¯ä¸€æ ‡è¯†ï¼Œæš‚æ— å®é™…æ„ä¹‰	1
    canal.ip	canal	serverç»‘å®šçš„æœ¬åœ°IPä¿¡æ¯ï¼Œå¦‚æœä¸é…ç½®ï¼Œé»˜è®¤é€‰æ‹©ä¸€ä¸ªæœ¬æœºIPè¿›è¡Œå¯åŠ¨æœåŠ¡	æ— 
    canal.port	canal serveræä¾›socketæœåŠ¡çš„ç«¯å£	11111
    canal.zkServers	canal serveré“¾æ¥zookeeperé›†ç¾¤çš„é“¾æ¥ä¿¡æ¯ ä¾‹å­ï¼š10.20.144.22:2181,10.20.144.51:2181	æ— 
    canal.zookeeper.flush.period	canalæŒä¹…åŒ–æ•°æ®åˆ°zookeeperä¸Šçš„æ›´æ–°é¢‘ç‡ï¼Œå•ä½æ¯«ç§’	1000
    canal.instance.memory.batch.mode	canalå†…å­˜storeä¸­æ•°æ®ç¼“å­˜æ¨¡å¼ 1. ITEMSIZE : æ ¹æ®buffer.sizeè¿›è¡Œé™åˆ¶ï¼Œåªé™åˆ¶è®°å½•çš„æ•°é‡ 2. MEMSIZE : æ ¹æ®buffer.size * buffer.memunitçš„å¤§å°ï¼Œé™åˆ¶ç¼“å­˜è®°å½•çš„å¤§å°	MEMSIZE
    canal.instance.memory.buffer.size	canalå†…å­˜storeä¸­å¯ç¼“å­˜bufferè®°å½•æ•°ï¼Œéœ€è¦ä¸º2çš„æŒ‡æ•°	16384
    canal.instance.memory.buffer.memunit	å†…å­˜è®°å½•çš„å•ä½å¤§å°ï¼Œé»˜è®¤1KBï¼Œå’Œbuffer.sizeç»„åˆå†³å®šæœ€ç»ˆçš„å†…å­˜ä½¿ç”¨å¤§å°	1024
    canal.instance.transactionn.size	æœ€å¤§äº‹åŠ¡å®Œæ•´è§£æçš„é•¿åº¦æ”¯æŒè¶…è¿‡è¯¥é•¿åº¦åï¼Œä¸€ä¸ªäº‹åŠ¡å¯èƒ½ä¼šè¢«æ‹†åˆ†æˆå¤šæ¬¡æäº¤åˆ°canal storeä¸­ï¼Œæ— æ³•ä¿è¯äº‹åŠ¡çš„å®Œæ•´å¯è§æ€§	1024
    canal.instance.fallbackIntervalInSeconds	canalå‘ç”Ÿmysqlåˆ‡æ¢æ—¶ï¼Œåœ¨æ–°çš„mysqlåº“ä¸ŠæŸ¥æ‰¾binlogæ—¶éœ€è¦å¾€å‰æŸ¥æ‰¾çš„æ—¶é—´ï¼Œå•ä½ç§’ è¯´æ˜ï¼šmysqlä¸»å¤‡åº“å¯èƒ½å­˜åœ¨è§£æå»¶è¿Ÿæˆ–è€…æ—¶é’Ÿä¸ç»Ÿä¸€ï¼Œéœ€è¦å›é€€ä¸€æ®µæ—¶é—´ï¼Œä¿è¯æ•°æ®ä¸ä¸¢	60
    canal.instance.detecting.enable	æ˜¯å¦å¼€å¯å¿ƒè·³æ£€æŸ¥	false
    canal.instance.detecting.sql	å¿ƒè·³æ£€æŸ¥sql	insert into retl.xdual values(1,now()) on duplicate key update x=now() canal.instance.detecting.interval.time	å¿ƒè·³æ£€æŸ¥é¢‘ç‡ï¼Œå•ä½ç§’	3
    canal.instance.detecting.retry.threshold	å¿ƒè·³æ£€æŸ¥å¤±è´¥é‡è¯•æ¬¡æ•°	3
    canal.instance.detecting.heartbeatHaEnable	å¿ƒè·³æ£€æŸ¥å¤±è´¥åï¼Œæ˜¯å¦å¼€å¯è‡ªåŠ¨mysqlè‡ªåŠ¨åˆ‡æ¢è¯´æ˜ï¼šæ¯”å¦‚å¿ƒè·³æ£€æŸ¥å¤±è´¥è¶…è¿‡é˜€å€¼åï¼Œå¦‚æœè¯¥é…ç½®ä¸ºtrueï¼Œcanalå°±ä¼šè‡ªåŠ¨é“¾åˆ°mysqlå¤‡åº“è·å–binlogæ•°æ®	false
    canal.instance.network.receiveBufferSize	ç½‘ç»œé“¾æ¥å‚æ•°ï¼ŒSocketOptions.SO_RCVBUF	16384
    canal.instance.network.sendBufferSize	ç½‘ç»œé“¾æ¥å‚æ•°ï¼ŒSocketOptions.SO_SNDBUF	16384
    canal.instance.network.soTimeout	ç½‘ç»œé“¾æ¥å‚æ•°ï¼ŒSocketOptions.SO_TIMEOUT	30
    canal.instance.filter.druid.ddl	æ˜¯å¦ä½¿ç”¨druidå¤„ç†æ‰€æœ‰çš„ddlè§£ææ¥è·å–åº“å’Œè¡¨å	true
    canal.instance.filter.query.dcl	æ˜¯å¦å¿½ç•¥dclè¯­å¥	false
    canal.instance.filter.query.dml	æ˜¯å¦å¿½ç•¥dmlè¯­å¥(mysql5.6ä¹‹åï¼Œåœ¨rowæ¨¡å¼ä¸‹æ¯æ¡DMLè¯­å¥ä¹Ÿä¼šè®°å½•SQLåˆ°binlogä¸­,å¯å‚è€ƒMySQLæ–‡æ¡£)	false
    canal.instance.filter.query.ddl	æ˜¯å¦å¿½ç•¥ddlè¯­å¥	false
    canal.instance.filter.table.error	æ˜¯å¦å¿½ç•¥binlogè¡¨ç»“æ„è·å–å¤±è´¥çš„å¼‚å¸¸(ä¸»è¦è§£å†³å›æº¯binlogæ—¶,å¯¹åº”è¡¨å·²è¢«åˆ é™¤æˆ–è€…è¡¨ç»“æ„å’Œbinlogä¸ä¸€è‡´çš„æƒ…å†µ)	false
    canal.instance.filter.rows	æ˜¯å¦dmlçš„æ•°æ®å˜æ›´äº‹ä»¶(ä¸»è¦é’ˆå¯¹ç”¨æˆ·åªè®¢é˜…ddl/dclçš„æ“ä½œ)	false
    canal.instance.filter.transaction.entry	æ˜¯å¦å¿½ç•¥äº‹åŠ¡å¤´å’Œå°¾,æ¯”å¦‚é’ˆå¯¹å†™å…¥kakfaçš„æ¶ˆæ¯æ—¶ï¼Œä¸éœ€è¦å†™å…¥TransactionBegin/Transactionendäº‹ä»¶	false
    canal.instance.binlog.format	æ”¯æŒçš„binlog formatæ ¼å¼åˆ—è¡¨(otterä¼šæœ‰æ”¯æŒformatæ ¼å¼é™åˆ¶)	ROW,STATEMENT,MIXED
    canal.instance.binlog.image	æ”¯æŒçš„binlog imageæ ¼å¼åˆ—è¡¨(otterä¼šæœ‰æ”¯æŒformatæ ¼å¼é™åˆ¶)	FULL,MINIMAL,NOBLOB
    canal.instance.get.ddl.isolation	ddlè¯­å¥æ˜¯å¦å•ç‹¬ä¸€ä¸ªbatchè¿”å›(æ¯”å¦‚ä¸‹æ¸¸dml/ddlå¦‚æœåšbatchå†…æ— åºå¹¶å‘å¤„ç†,ä¼šå¯¼è‡´ç»“æ„ä¸ä¸€è‡´)	false
    canal.instance.parser.parallel	æ˜¯å¦å¼€å¯binlogå¹¶è¡Œè§£ææ¨¡å¼(ä¸²è¡Œè§£æèµ„æºå ç”¨å°‘,ä½†æ€§èƒ½æœ‰ç“¶é¢ˆ, å¹¶è¡Œè§£æå¯ä»¥æå‡è¿‘2.5å€+)	true
    canal.instance.parser.parallelBufferSize	binlogå¹¶è¡Œè§£æçš„å¼‚æ­¥ringbufferé˜Ÿåˆ—(å¿…é¡»ä¸º2çš„æŒ‡æ•°)	256
    canal.instance.tsdb.enable	æ˜¯å¦å¼€å¯tablemetaçš„tsdbèƒ½åŠ›	true
    canal.instance.tsdb.dir	ä¸»è¦é’ˆå¯¹h2-tsdb.xmlæ—¶å¯¹åº”h2æ–‡ä»¶çš„å­˜æ”¾ç›®å½•,é»˜è®¤conf/xx/h2.mv.db
    canal.instance.tsdb.url	jdbc urlçš„é…ç½®(h2çš„åœ°å€ä¸ºé»˜è®¤å€¼ï¼Œå¦‚æœæ˜¯mysqléœ€è¦è‡ªè¡Œå®šä¹‰)	jdbc:h2: ${canal.instance.tsdb.dir} /h2;CACHE_SIZE=1000;MODE=MYSQL;
    canal.instance.tsdb.dbUsername	jdbc urlçš„é…ç½®(h2çš„åœ°å€ä¸ºé»˜è®¤å€¼ï¼Œå¦‚æœæ˜¯mysqléœ€è¦è‡ªè¡Œå®šä¹‰)	canal
    canal.instance.tsdb.dbPassword	jdbc urlçš„é…ç½®(h2çš„åœ°å€ä¸ºé»˜è®¤å€¼ï¼Œå¦‚æœæ˜¯mysqléœ€è¦è‡ªè¡Œå®šä¹‰)	canal
    canal.instance.rds.accesskey	aliyunè´¦å·çš„akä¿¡æ¯ (å¦‚æœä¸éœ€è¦åœ¨æœ¬åœ°binlogè¶…è¿‡18å°æ—¶è¢«æ¸…ç†åè‡ªåŠ¨ä¸‹è½½ossä¸Šçš„binlogï¼Œå¯ä»¥å¿½ç•¥è¯¥å€¼)	æ— 
    canal.instance.rds.secretkey	aliyunè´¦å·çš„skä¿¡æ¯(å¦‚æœä¸éœ€è¦åœ¨æœ¬åœ°binlogè¶…è¿‡18å°æ—¶è¢«æ¸…ç†åè‡ªåŠ¨ä¸‹è½½ossä¸Šçš„binlogï¼Œå¯ä»¥å¿½ç•¥è¯¥å€¼)	æ— 
    instance.properties
    å‚æ•°åå­—	å‚æ•°è¯´æ˜	é»˜è®¤å€¼
    canal.instance.mysql.slaveId	mysqlé›†ç¾¤é…ç½®ä¸­çš„serverIdæ¦‚å¿µï¼Œéœ€è¦ä¿è¯å’Œå½“å‰mysqlé›†ç¾¤ä¸­idå”¯ä¸€ (v1.1.xç‰ˆæœ¬ä¹‹åcanalä¼šè‡ªåŠ¨ç”Ÿæˆï¼Œä¸éœ€è¦æ‰‹å·¥æŒ‡å®š)	æ— 
    canal.instance.master.address	mysqlä¸»åº“é“¾æ¥åœ°å€	127.0.0.1:3306
    canal.instance.master.journal.name	mysqlä¸»åº“é“¾æ¥æ—¶èµ·å§‹çš„binlogæ–‡ä»¶	æ— 
    canal.instance.master.position	mysqlä¸»åº“é“¾æ¥æ—¶èµ·å§‹çš„binlogåç§»é‡	æ— 
    canal.instance.master.timestamp	mysqlä¸»åº“é“¾æ¥æ—¶èµ·å§‹çš„binlogçš„æ—¶é—´æˆ³	æ— 
    canal.instance.gtidon	æ˜¯å¦å¯ç”¨mysql gtidçš„è®¢é˜…æ¨¡å¼	false
    canal.instance.master.gtid	mysqlä¸»åº“é“¾æ¥æ—¶å¯¹åº”çš„gtidä½ç‚¹	æ— 
    canal.instance.dbUsername	mysqlæ•°æ®åº“å¸å·	canal
    canal.instance.dbPassword	mysqlæ•°æ®åº“å¯†ç 	canal
    canal.instance.defaultDatabaseName	mysqlé“¾æ¥æ—¶é»˜è®¤schema	æ— 
    canal.instance.connectionCharset	mysql æ•°æ®è§£æç¼–ç 	UTF-8
    canal.instance.filter.regex	mysql æ•°æ®è§£æå…³æ³¨çš„è¡¨ï¼ŒPerlæ­£åˆ™è¡¨è¾¾å¼.å¤šä¸ªæ­£åˆ™ä¹‹é—´ä»¥é€—å·(,)åˆ†éš”ï¼Œè½¬ä¹‰ç¬¦éœ€è¦åŒæ–œæ (\) å¸¸è§ä¾‹å­ï¼š 1. æ‰€æœ‰è¡¨ï¼š.* or .\â€¦ 2. canal schemaä¸‹æ‰€æœ‰è¡¨ï¼š canal\â€¦* 3. canalä¸‹çš„ä»¥canalæ‰“å¤´çš„è¡¨ï¼šcanal\.canal.* 4. canal schemaä¸‹çš„ä¸€å¼ è¡¨ï¼šcanal.test1 5. å¤šä¸ªè§„åˆ™ç»„åˆä½¿ç”¨ï¼šcanal\â€¦*,mysql.test1,mysql.test2 (é€—å·åˆ†éš”)	.\â€¦
    canal.instance.filter.black.regex	mysql æ•°æ®è§£æè¡¨çš„é»‘åå•ï¼Œè¡¨è¾¾å¼è§„åˆ™è§ç™½åå•çš„è§„åˆ™	æ— 
    canal.instance.rds.instanceId	aliyun rdså¯¹åº”çš„å®ä¾‹idä¿¡æ¯(å¦‚æœä¸éœ€è¦åœ¨æœ¬åœ°binlogè¶…è¿‡18å°æ—¶è¢«æ¸…ç†åè‡ªåŠ¨ä¸‹è½½ossä¸Šçš„binlogï¼Œå¯ä»¥å¿½ç•¥è¯¥å€¼)	æ— 
    è¯´æ˜ï¼š
    mysqlé“¾æ¥æ—¶çš„èµ·å§‹ä½ç½®
    canal.instance.master.journal.name + canal.instance.master.position : ç²¾ç¡®æŒ‡å®šä¸€ä¸ªbinlogä½ç‚¹ï¼Œè¿›è¡Œå¯åŠ¨
    canal.instance.master.timestamp : æŒ‡å®šä¸€ä¸ªæ—¶é—´æˆ³ï¼Œcanalä¼šè‡ªåŠ¨éå†mysql binlogï¼Œæ‰¾åˆ°å¯¹åº”æ—¶é—´æˆ³çš„binlogä½ç‚¹åï¼Œè¿›è¡Œå¯åŠ¨
    ä¸æŒ‡å®šä»»ä½•ä¿¡æ¯ï¼šé»˜è®¤ä»å½“å‰æ•°æ®åº“çš„ä½ç‚¹ï¼Œè¿›è¡Œå¯åŠ¨ã€‚(show master status)
    #####mysqlè§£æå…³æ³¨è¡¨å®šä¹‰
    æ ‡å‡†çš„Perlæ­£åˆ™ï¼Œæ³¨æ„è½¬ä¹‰æ—¶éœ€è¦åŒæ–œæ ï¼š\
    #####mysqlé“¾æ¥çš„ç¼–ç 
    ç›®å‰canalç‰ˆæœ¬ä»…æ”¯æŒä¸€ä¸ªæ•°æ®åº“åªæœ‰ä¸€ç§ç¼–ç ï¼Œå¦‚æœä¸€ä¸ªåº“å­˜åœ¨å¤šä¸ªç¼–ç ï¼Œéœ€è¦é€šè¿‡filter.regexé…ç½®ï¼Œå°†å…¶æ‹†åˆ†ä¸ºå¤šä¸ªcanal instanceï¼Œä¸ºæ¯ä¸ªinstanceæŒ‡å®šä¸åŒçš„ç¼–ç 