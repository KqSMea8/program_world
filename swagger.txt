Swagger2 çš„æ­£ç¡®ç©å„¿æ³•
ViYoung  JavaçŸ¥éŸ³  ä»Šå¤©
ç‚¹å‡»ä¸Šæ–¹â€œJavaçŸ¥éŸ³â€ï¼Œé€‰æ‹©â€œç½®é¡¶å…¬ä¼—å·â€

æŠ€æœ¯æ–‡ç« ç¬¬ä¸€æ—¶é—´é€è¾¾ï¼



ä½œè€…ï¼šViYoung

æ¥è‡ªå…¬ä¼—å·ï¼šViçš„æŠ€æœ¯åšå®¢

æ¨èé˜…è¯»

1. SpringBoot æ•´åˆç¯‡

2. æ‰‹å†™ä¸€å¥—è¿·ä½ ç‰ˆHTTPæœåŠ¡å™¨

3. è®°ä½ï¼šæ°¸è¿œä¸è¦åœ¨MySQLä¸­ä½¿ç”¨UTF-8

4. Springbootå¯åŠ¨åŸç†è§£æ

Swagger2ç®€ä»‹
ç®€å•çš„æ¥è¯´ï¼ŒSwagger2çš„è¯ç”Ÿå°±æ˜¯ä¸ºäº†è§£å†³å‰åç«¯å¼€å‘äººå‘˜è¿›è¡Œäº¤æµçš„æ—¶å€™APIæ–‡æ¡£éš¾ä»¥ç»´æŠ¤çš„ç—›ç‚¹ï¼Œå®ƒå¯ä»¥å’Œæˆ‘ä»¬çš„Javaç¨‹åºå®Œç¾çš„ç»“åˆåœ¨ä¸€èµ·ï¼Œå¹¶ä¸”å¯ä»¥ä¸æˆ‘ä»¬çš„å¦ä¸€å¼€å‘åˆ©å™¨Spring Bootæ¥é…åˆä½¿ç”¨ã€‚

å¼€å§‹ä½¿ç”¨
ç¬¬ä¸€æ­¥ï¼šå¯¼å…¥POMæ–‡ä»¶
         <dependency>
            <groupId>io.springfox</groupId>
            <artifactId>springfox-swagger2</artifactId>
            <version>2.9.2</version>
        </dependency>

        <!-- è¿™é‡Œä½¿ç”¨ swagger-bootstrap-ui æ›¿ä»£äº†åŸæœ‰ä¸‘é™‹çš„uiï¼Œæ‹¯æ•‘å¤„å¥³åº§~ -->
        <dependency>
            <groupId>com.github.xiaoymin</groupId>
            <artifactId>swagger-bootstrap-ui</artifactId>
            <version>1.9.0</version>
        </dependency>
ç¬¬äºŒæ­¥ï¼šæ·»åŠ é…ç½®ç±»
æˆ‘ä»¬éœ€è¦æ–°å¢ä¸€ä¸ªSwagger2Config çš„é…ç½®ç±»ï¼š

/**
 *    Swagger2 é…ç½®ç±»
 * @author vi
 * @since 2019/3/6 8:31 PM
 */
@Configuration
public class Swagger2Config {

    @Bean
    public Docket createRestApi() {
        return new Docket(DocumentationType.SWAGGER_2)
                .apiInfo(apiInfo())
                .select()
                .apis(RequestHandlerSelectors.basePackage("indi.viyoung.viboot.*"))
                .paths(PathSelectors.any())
                .build();
    }

    private ApiInfo apiInfo() {
        return new ApiInfoBuilder()
                .title("viboot-swagger2")    //æ ‡é¢˜
                .description("Restful-API-Doc")    //æè¿°
                .termsOfServiceUrl("https://www.cnblogs.com/viyoung") //è¿™é‡Œé…ç½®çš„æ˜¯æœåŠ¡ç½‘ç«™ï¼Œæˆ‘å†™çš„æ˜¯æˆ‘çš„åšå®¢å›­ç«™ç‚¹~æ¬¢è¿å…³æ³¨~
                .contact(new Contact("Viçš„æŠ€æœ¯åšå®¢", "https://www.cnblogs.com/viyoung", "18530069930@163.com")) // ä¸‰ä¸ªå‚æ•°ä¾æ¬¡æ˜¯å§“åï¼Œä¸ªäººç½‘ç«™ï¼Œé‚®ç®±
                .version("1.0") //ç‰ˆæœ¬
                .build();
    }
}
ç¬¬ä¸‰æ­¥ï¼šåœ¨å¯åŠ¨ç±»ä¸­æ·»åŠ é…ç½®
æ³¨æ„ä¸€å®šè¦è®°å¾—æ·»åŠ @EnableSwagger2æ³¨è§£

/**
 * @author vi
 * @since 2019/3/6 6:35 PM
 */
@SpringBootApplication
@ComponentScan(value = "indi.viyoung.viboot.*")
@MapperScan(value = "indi.viyoung.viboot.swagger2.mapper")
@EnableSwagger2
@EnableSwaggerBootstrapUI
public class ViBootSwaggerApplication {
    public static void main(String[] args) {
        SpringApplication.run(ViBootSwaggerApplication.class, args);
    }
}
ç¬¬å››æ­¥ï¼šé€šè¿‡æ³¨è§£æ¥å®ŒæˆAPIæ–‡æ¡£
1. @Api
æ³¨è§£åç§°	æ³¨è§£å±æ€§	ä½œç”¨åŸŸ	å±æ€§ä½œç”¨
@Api	tags	ç±»	è¯´æ˜è¯¥ç±»çš„ä½œç”¨

value	ç±»	è¯´æ˜è¯¥ç±»çš„ä½œç”¨
ä¸¾ä¸ªğŸŒ°ï¼š

@Api(value = "ç”¨æˆ·ç±»æ§åˆ¶å™¨",tags="ç”¨æˆ·ç±»æ§åˆ¶å™¨")
public class UserController {
...
}


2 . @ApiOperation
æ³¨è§£åç§°	æ³¨è§£å±æ€§	ä½œç”¨åŸŸ	å±æ€§ä½œç”¨
@ApiOperation()	value	æ–¹æ³•	æè¿°æ–¹æ³•ä½œç”¨

notes	æ–¹æ³•	æç¤ºå†…å®¹

tags	æ–¹æ³•	åˆ†ç»„
ä¸¾ä¸ªğŸŒ°ï¼š

@ApiOperation(value = "è·å–ç”¨æˆ·åˆ—è¡¨",notes = "è·å–ç”¨æˆ·åˆ—è¡¨")
public List<User> get() {
     ...
}


3. @ApiParam
æ³¨è§£åç§°	æ³¨è§£å±æ€§	ä½œç”¨åŸŸ	å±æ€§ä½œç”¨
@ApiParam()	name	æ–¹æ³•å‚æ•°	å‚æ•°å

value	æ–¹æ³•å‚æ•°	å‚æ•°è¯´æ˜

required	æ–¹æ³•å‚æ•°	æ˜¯å¦å¿…å¡«
ä¸¾ä¸ªğŸŒ°ï¼š

@ApiOperation(value="è·å–ç”¨æˆ·è¯¦ç»†ä¿¡æ¯", notes="æ ¹æ®urlçš„idæ¥è·å–ç”¨æˆ·è¯¦ç»†ä¿¡æ¯")
public User get(@ApiParam(name="id",value="ç”¨æˆ·id",required=true) Long id) {
    log.info("GET..{}...æ–¹æ³•æ‰§è¡Œã€‚ã€‚ã€‚",id);
    return userService.getById(id);
}


4. @ApiModel && @ApiModelProperty
æ³¨è§£åç§°	æ³¨è§£å±æ€§	ä½œç”¨åŸŸ	å±æ€§ä½œç”¨
@ApiModel()	value	ç±»	å¯¹è±¡å

description	ç±»	æè¿°
@ApiModelProperty()	value	æ–¹æ³•	å­—æ®µè¯´æ˜

name	æ–¹æ³•	å±æ€§å

dataType	æ–¹æ³•	å±æ€§ç±»å‹

required	æ–¹æ³•	æ˜¯å¦å¿…å¡«

example	æ–¹æ³•	ä¸¾ä¾‹

hidden	æ–¹æ³•	éšè—
ä¸¾ä¸ªğŸŒ°ï¼š

@ApiModel(value="userå¯¹è±¡",description="ç”¨æˆ·å¯¹è±¡user")
public class User implements Serializable {

    private static final long serialVersionUID = 1L;

    @TableId(value = "id", type = IdType.AUTO)
    @ApiModelProperty(value = "ç”¨æˆ·ID",example = "1000001",hidden=true)
    private Long id;

    @ApiModelProperty(value="ç”¨æˆ·å",required = true,dataType = "String")
    private String userName;

    @ApiModelProperty(value = "å¯†ç ")
    private String password;
}


5. @ApiImplicitParam && @ApiImplicitParams
@ApiImplicitParamå¯ä»¥å•ä¸ªç”¨äºæ–¹æ³•ä¹‹ä¸Šï¼Œå¤šä¸ªå‚æ•°çš„è¯å¯ä»¥æŠŠ@ApiImplicitParamæ”¾åˆ°@ApiImplicitParamsä¸­ï¼Œè¿™é‡Œåªç½—åˆ—@ApiImplicitParamçš„å±æ€§ï¼š

æ³¨è§£åç§°	æ³¨è§£å±æ€§	ä½œç”¨åŸŸ	å±æ€§ä½œç”¨
@ApiImplicitParam()	value	æ–¹æ³•	å‚æ•°è¯´æ˜

name	æ–¹æ³•	å‚æ•°å

dataType	æ–¹æ³•	æ•°æ®ç±»å‹

paramType	æ–¹æ³•	å‚æ•°ç±»å‹

example	æ–¹æ³•	ä¸¾ä¾‹
ä¸¾ä¸ªğŸŒ°ï¼š

    @ApiImplicitParams({
            @ApiImplicitParam(name = "user", value = "ç”¨æˆ·å®ä½“user", required = true, dataType = "User")
    })
    public void put(User user) {
        userService.updateById(user);
        log.info("PUTæ–¹æ³•æ‰§è¡Œã€‚ã€‚ã€‚");
    }



è¿™é‡Œéœ€è¦æ³¨æ„ä¸€ç‚¹ï¼Œæˆ‘ä»¬å¹¶æ²¡æœ‰åœ¨æ³¨è§£ä¸­å†™å›¾ä¸­åœˆä¸­çš„ä¸¤ä¸ªå‚æ•°ï¼Œè¿™ä¸ªæ˜¯å»è¯»å–äº†æˆ‘ä»¬åˆšåˆšä¸ºUserç±»çš„æ³¨è§£ï¼Œå¹¶å°†ç”¨æˆ·åè®¾ç½®ä¸ºå¿…å¡«ï¼
6.@ApiResposne && @ApiResponses
@ApiResponsesä¸@ApiResponseçš„å…³ç³»å’Œ@ApiImplicitParam && @ApiImplicitParams çš„å…³ç³»å’Œç”¨æ³•éƒ½æ˜¯ç±»ä¼¼çš„

æ³¨è§£åç§°	æ³¨è§£å±æ€§	ä½œç”¨åŸŸ	å±æ€§ä½œç”¨
@ApiResponse()	response	æ–¹æ³•	è¿”å›ç±»

code	æ–¹æ³•	è¿”å›ç 

message	æ–¹æ³•	è¿”å›ä¿¡æ¯

examples	æ–¹æ³•	ä¾‹å­

æœ€åå†èŠèŠè¿™ä¸ªUI
å…ˆè´´å‡ å¼ spring-foxçš„uiï¼ˆæ­£æ˜¯æˆ‘ä»¬æ‰€ç†ŸçŸ¥çš„é‚£ä¸€å¥—ï¼‰





ç›¸ä¿¡çœ‹åˆ°è¿™é‡Œï¼Œå¤§å®¶å¿ƒé‡Œå¯¹äºè¿™ä¸¤å¥—UIçš„é€‰æ‹©åº”è¯¥éƒ½æœ‰ä¸ªç­”æ¡ˆäº†ï¼ˆPSï¼šä¸æ’é™¤å’Œæˆ‘çš„å®¡ç¾ä¸ä¸€è‡´çš„~ï¼‰ï¼Œä¸ªäººè§‰å¾—bootstrapé£æ ¼çš„uiä¸ä»…å¥½çœ‹ï¼Œè€Œä¸”æœ‰å„ç§å¼ºå¤§çš„åŠŸèƒ½~

å¯¼å‡ºmdæ–‡æ¡£


å‚æ•°ç¼“å­˜
------------------------


APIæ–‡æ¡£æ±‡é›†å·¥å…·ï¼šSwagger Butler


ä»Šå¤©æ¨èä¸€ä¸ªTJæœ‹å‹çš„å¼€æºé¡¹ç›®ï¼Œå›½äº§ä½œå“ã€‚åœ¨Spring Bootã€Spring Cloudæµè¡Œçš„å½“ä¸‹ï¼Œè¿˜æ˜¯éå¸¸å®ç”¨çš„ã€‚æˆ‘ä»¬è‡ªå·±ä¹Ÿç”¨äº†ä¸€ä¸‹ï¼Œæ­£å¥½æœ€è¿‘å‘å¸ƒ2.0ï¼Œæ”¯æŒSpring Boot 2.xäº†ã€‚æ‰€ä»¥ç»™å¤§å®¶æ¨èä¸€ä¸‹~

å½“æˆ‘ä»¬æ„å»ºåˆ†å¸ƒå¼ç³»ç»Ÿçš„æ—¶å€™ï¼Œè™½ç„¶æˆ‘ä»¬å¯ä»¥ç”¨Swaggeræ¥æ–¹ä¾¿ä¸ºæ¯ä¸ªæœåŠ¡è‡ªåŠ¨äº§å‡ºAPIæ–‡æ¡£é¡µé¢ã€‚ä½†æ˜¯éšç€æœåŠ¡æ•°é‡çš„å¢å¤šï¼Œå†…éƒ¨æœåŠ¡é—´çš„ä¾èµ–å…³ç³»çš„å¤æ‚åº¦å¢åŠ ï¼Œæ¯ä¸ªæœåŠ¡å¼€å‘äººå‘˜è¦å…³å¿ƒå’ŒæŸ¥é˜…çš„æ–‡æ¡£å˜å¾—è¶Šæ¥è¶Šå¤šã€‚ç”±äºæ¯ä¸ªæœåŠ¡çš„æ–‡æ¡£åœ°å€å¯èƒ½éƒ½ä¸ä¸€æ ·ï¼Œè¿™ä½¿å¾—ä¸å¾—ä¸ç»´æŠ¤ä¸€ä¸ªæ–‡æ¡£çš„ç´¢å¼•æ¥æ–¹ä¾¿æŸ¥é˜…ï¼Œå¹¶ä¸”è¿™ä¸ªç´¢å¼•è¿˜éœ€è¦ä¸æ–­çš„å»ç»´æŠ¤æ›´æ–°ã€‚

é‚£ä¹ˆæœ‰æ²¡æœ‰ä»€ä¹ˆå·¥å…·å¯ä»¥å¸®æˆ‘ä»¬å¿«é€Ÿçš„æ±‡é›†è¿™äº›æœåŠ¡çš„Swaggeræ–‡æ¡£å‘¢ï¼Ÿåªéœ€è¦è®°ä½ä¸€ä¸ªè®¿é—®åœ°å€ï¼Œå°±å¯ä»¥è®¿é—®æ‰€æœ‰æœåŠ¡çš„APIæ–‡æ¡£ï¼Ÿå½“æœåŠ¡å¢åŠ çš„æ—¶å€™ï¼Œä¸éœ€è¦æ‰‹å·¥ç»´æŠ¤å°±èƒ½è‡ªåŠ¨å‘ç°æ–°æœåŠ¡çš„APIæ–‡æ¡£ï¼Ÿå¦‚æœæ‚¨æœ‰ä¸Šé¢çš„è¿™äº›é—®é¢˜ï¼Œé‚£ä¹ˆä¸å¦¨çœ‹çœ‹è¿™ä¸ªé¡¹ç›®ï¼Œæˆ–è®¸å¯ä»¥è§£å†³æ‚¨çš„è¿™äº›çƒ¦æ¼ï¼

Swagger Butleræ˜¯ä¸€ä¸ªåŸºäºSwaggerä¸Zuulæ„å»ºçš„APIæ–‡æ¡£æ±‡é›†å·¥å…·ã€‚é€šè¿‡æ„å»ºä¸€ä¸ªç®€å•çš„Spring Bootåº”ç”¨ï¼Œå¢åŠ ä¸€äº›é…ç½®å°±èƒ½å°†ç°æœ‰æ•´åˆäº†Swaggerçš„Webåº”ç”¨çš„APIæ–‡æ¡£éƒ½æ±‡æ€»åˆ°ä¸€èµ·ï¼Œæ–¹ä¾¿æŸ¥çœ‹ä¸æµ‹è¯•ã€‚

é¡¹ç›®åœ°å€

Githubï¼šhttps://github.com/dyc87112/swagger-butler

Giteeï¼šhttps://gitee.com/didispace/swagger-butler

ç‰ˆæœ¬è¯´æ˜
swagger-butlerçš„ä½¿ç”¨ç‰ˆæœ¬ä¸Spring Bootç‰ˆæœ¬ç›´æ¥ç›¸å…³ï¼Œå¯¹åº”å…³ç³»å¦‚ä¸‹ï¼›

Spring Bootç‰ˆæœ¬	swagger-butlerç‰ˆæœ¬
1.x	1.x
2.x	2.x
å½“å‰æœ€æ–°ç‰ˆæœ¬2.0.0ï¼Œ1.xç‰ˆæœ¬å°†ä¸å†ç»§ç»­æ›´æ–°ã€‚

å¿«é€Ÿå…¥é—¨
è¯¥å·¥å…·çš„æ—¶å€™éå¸¸ç®€å•ï¼Œå…ˆé€šè¿‡ä¸‹é¢å‡ æ­¥ç®€å•å…¥é—¨ï¼š

ç¬¬ä¸€æ­¥ï¼šæ„å»ºä¸€ä¸ªåŸºç¡€çš„Spring Bootåº”ç”¨

å¦‚æ‚¨è¿˜ä¸çŸ¥é“å¦‚ä½•åˆ›å»ºSpring Bootåº”ç”¨ï¼Œå¯ä»¥å…ˆé˜…è¯»æœ¬ç¯‡å…¥é—¨æ–‡ç« 

ç¬¬äºŒæ­¥ï¼šåœ¨pom.xmlä¸­å¼•å…¥ä¾èµ–

<dependencies>


<dependency>


<groupId>
com.didispace
</groupId>


<artifactId>
swagger-butler-core
</artifactId>


<version>
2.0.0
</version>


</dependency>

</dependencies>

ç¬¬ä¸‰æ­¥ï¼šåˆ›å»ºåº”ç”¨ä¸»ç±»ï¼Œå¢åŠ  @EnableSwaggerButleræ³¨è§£å¼€å¯Swagger ButleråŠŸèƒ½

@EnableSwaggerButler

@SpringBootApplication

public

class

StaticApplication

{




public

static

void
 main
(
String
[]
 args
)

{


SpringApplication
.
run
(
StaticApplication
.
class
);


}



}

ç¬¬å››æ­¥ï¼šé…ç½®æ–‡ä»¶ä¸­å¢åŠ Swaggeræ–‡æ¡£çš„åœ°å€é…ç½®

spring
.
application
.
name
=
swagger
-
butler
-
example
-
static

server
.
port
=
11000



# default config

swagger
.
butler
.
api
-
docs
-
path
=
/v2/
api
-
docs

swagger
.
butler
.
swagger
-
version
=
2.0



# swagger resource

zuul
.
routes
.
user
.
path
=
/service-a/
**

zuul
.
routes
.
user
.
url
=
http
:
//localhost:10010/

swagger
.
butler
.
resources
.
user
.
name
=
user
-
service



# swagger resource

zuul
.
routes
.
product
.
path
=
/service-b/
**

zuul
.
routes
.
product
.
url
=
http
:
//localhost:10020/

swagger
.
butler
.
resources
.
product
.
name
=
product
-
service

swagger
.
butler
.
resources
.
product
.
api
-
docs
-
path
=
/xxx/
v2
/
api
-
docs

swagger
.
butler
.
resources
.
product
.
swagger
-
version
=
2.0

ä¸Šé¢é…ç½®äº†ä¸¤ä¸ªæ–‡æ¡£ä½ç½®ï¼Œç”±äºè¿™é‡Œè¿˜æ²¡æœ‰å¼•å…¥æœåŠ¡å‘ç°æœºåˆ¶ï¼Œæ‰€ä»¥Zuulçš„è·¯ç”±éœ€è¦æˆ‘ä»¬è‡ªå·±é…ç½®ã€‚ç„¶ååœ¨é…ç½®resourceä¿¡æ¯çš„æ—¶å€™ï¼Œä»1.1.0ç‰ˆæœ¬å¼€å§‹åšäº†è¾ƒå¤§çš„è°ƒæ•´ï¼Œç”±äºå…·ä½“çš„è®¿é—®è·¯å¾„æ˜¯å¯ä»¥é€šè¿‡è·¯ç”±ä¿¡æ¯äº§ç”Ÿçš„ï¼Œæ‰€ä»¥å¯¹äºresourceçš„é…ç½®ä¿¡æ¯åªå…³æ³¨ä¸‰ä¸ªå†…å®¹ï¼š

nameï¼šAPIæ–‡æ¡£åœ¨swaggerä¸­å±•ç°åç§°

api-docs-pathï¼šè¦è·å–çš„swaggeræ–‡æ¡£çš„å…·ä½“è·¯å¾„ï¼›å¦‚æœä¸é…ç½®ä¼šä½¿ç”¨å…¨å±€çš„ swagger.butler.api-docs-pathé…ç½®ï¼Œé»˜è®¤ä¸º /v2/api-docsã€‚ï¼›è¿™é‡Œçš„é…ç½®ä¸»è¦ç”¨æˆ·ä¸€äº›ç‰¹æ®Šæƒ…å†µï¼Œæ¯”å¦‚æœåŠ¡è‡ªèº«è®¾ç½®äº†context-pathï¼Œæˆ–è€…ä¿®æ”¹äº†swaggeré»˜è®¤çš„æ–‡æ¡£è·¯å¾„

swagger-versionï¼šswaggerç‰ˆæœ¬ä¿¡æ¯ï¼›å¦‚æœä¸é…ç½®ä¼šä½¿ç”¨å…¨å±€çš„ swagger.butler.swagger-versioné…ç½®ï¼Œé»˜è®¤ä¸º 2.0ã€‚

ç¬¬äº”æ­¥ï¼šæŸ¥çœ‹èšåˆæ–‡æ¡£ã€‚

åŸç”Ÿæ–‡æ¡£ï¼šè®¿é—® http://localhost:11000/swagger-ui.html





å¢å¼ºæ–‡æ¡£ï¼šè®¿é—® http://localhost:11000/doc.html



ä»£ç ç¤ºä¾‹å…·ä½“å¯è§ swagger-butler-example-staticç›®å½•

Zuulçš„è·¯ç”±ä¸SwaggerResourcesé…ç½®ä¹‹é—´çš„å…³ç³»
å¦‚ä¸Šç¤ºä¾‹ä¸­ <route-name>å±•ç¤ºäº†Zuulçš„è·¯ç”±åç§°ä¸SwaggerResourcesé…ç½®ä¹‹é—´çš„å…³è”å…³ç³»

zuul
.
routes
.<
route
-
name
>.
path
=
/service-b/
**

zuul
.
routes
.<
route
-
name
>.
url
=
http
:
//localhost:10020/



swagger
.
butler
.
resources
.<
route
-
name
>.
name
=
product
-
service

swagger
.
butler
.
resources
.<
route
-
name
>.
api
-
docs
-
path
=
/xxx/
v2
/
api
-
docs

swagger
.
butler
.
resources
.<
route
-
name
>.
swagger
-
version
=
2.0

æ³¨æ„ï¼šåœ¨æ²¡æœ‰ä½¿ç”¨è‡ªåŠ¨é…ç½®æˆ–æ•´åˆæœåŠ¡æ²»ç†çš„æ—¶å€™ï¼Œè¦ç”ŸæˆSwaggeræ–‡æ¡£çš„æ—¶å€™ï¼Œresourcesä¿¡æ¯ä¸­çš„ nameå±æ€§æ˜¯å¿…é¡»é…ç½®çš„ï¼Œ api-docs-pathå’Œ swagger-versionä¸é…ç½®çš„æ—¶å€™ä¼šä½¿ç”¨é»˜è®¤çš„å…¨å±€é…ç½®

å…¨å±€é…ç½®
å¯¹äºSwaggeræ–‡æ¡£è·å–çš„å…¨å±€é…ç½®å†…å®¹ï¼Œç›®å‰ä¸»è¦åŒ…å«ä¸‹é¢å‡ ä¸ªå‚æ•°ï¼š

swagger
.
butler
.
api
-
docs
-
path
=
/v2/
api
-
docs

swagger
.
butler
.
swagger
-
version
=
2.0

ä½¿ç”¨Zuulä¸­çš„è·¯ç”±è‡ªåŠ¨é…ç½®
åœ¨å¿«é€Ÿå…¥é—¨ç¤ºä¾‹ä¸­æˆ‘ä»¬é…ç½®äº†ä¸¤ä¸ªè·¯ç”±ä¿¡æ¯ï¼ŒåŒæ—¶ä¸ºè¿™ä¸¤ä¸ªè·¯ç”±ä¿¡æ¯é…ç½®äº†å¯¹åº”çš„Swaggerä¿¡æ¯æ¥è·å–APIæ–‡æ¡£è¯¦æƒ…ï¼Œä»1.1.0ç‰ˆæœ¬å¼€å§‹ï¼Œå¢åŠ äº†å‡ ä¸ªé€šè¿‡Zuulçš„è·¯ç”±é…ç½®æ¥è‡ªåŠ¨ç”Ÿæˆæ–‡æ¡£ä¿¡æ¯çš„å‚æ•°ï¼Œè¿™æ ·å¯ä»¥å‡å°‘å¿«é€Ÿå…¥é—¨ç¤ºä¾‹ä¸­é‚£äº›ç¹ççš„é…ç½®ã€‚å¯¹äºå¿«é€Ÿå…¥é—¨ä¾‹å­ï¼Œæˆ‘ä»¬å¯ä»¥åšå¦‚ä¸‹æ”¹é€ ï¼š

# swagger resource

zuul
.
routes
.
user
.
path
=
/service-a/
**

zuul
.
routes
.
user
.
url
=
http
:
//localhost:10010/



# swagger resource

zuul
.
routes
.
product
.
path
=
/service-b/
**

zuul
.
routes
.
product
.
url
=
http
:
//localhost:10020/



# use zuul routes generate swagger resources

swagger
.
butler
.
auto
-
generate
-
from
-
zuul
-
routes
=
true

åœ¨è®¾ç½®äº† swagger.butler.auto-generate-from-zuul-routes=trueä¹‹åä¼šé»˜è®¤çš„æ ¹æ®zuulä¸­çš„è·¯ç”±ä¿¡æ¯æ¥ç”ŸæˆSwaggerResourceã€‚å…¶ä¸­ï¼ŒåŸæ¥resourceä¸­çš„ nameä¼šä½¿ç”¨zuul routeçš„åç§°ï¼ˆæ¯”å¦‚ï¼šä¸Šé¢çš„userå’Œproductï¼‰ï¼Œè€Œ api-docs-pathå’Œ swagger-versioné…ç½®ä¼šä½¿ç”¨é»˜è®¤çš„å…¨å±€é…ç½®ã€‚å¦‚æœresourceä¸­çš„ä¸‰ä¸ªå‚æ•°æœ‰ç‰¹æ®Šæƒ…å†µè¦å¤„ç†ï¼Œå¯ä»¥é‡‡ç”¨å¿«é€Ÿå…¥é—¨ä¸­çš„é…ç½®æ–¹å¼æ¥ç‰¹åˆ«æŒ‡å®šå³å¯ã€‚

å¿½ç•¥æŸäº›è·¯ç”±ç”Ÿæˆ
# swagger resource

zuul
.
routes
.
user
.
path
=
/service-a/
**

zuul
.
routes
.
user
.
url
=
http
:
//localhost:10010/



# swagger resource

zuul
.
routes
.
product
.
path
=
/service-b/
**

zuul
.
routes
.
product
.
url
=
http
:
//localhost:10020/



# use zuul routes generate swagger resources

swagger
.
butler
.
auto
-
generate
-
from
-
zuul
-
routes
=
true

swagger
.
butler
.
ignore
-
routes
=
product

å¦‚ä¸Šç¤ºä¾‹ï¼Œé€šè¿‡ swagger.butler.ignore-routeså‚æ•°å¯ä»¥ä»å½“å‰é…ç½®çš„è·¯ç”±ä¿¡æ¯ä¸­æ’é™¤æŸäº›è·¯ç”±å†…å®¹ä¸ç”Ÿæˆæ–‡æ¡£ï¼Œé…ç½®å†…å®¹ä¸ºzuulä¸­çš„è·¯ç”±åç§°ï¼Œé…ç½®å¤šä¸ªçš„æ—¶å€™ä½¿ç”¨ ,åˆ†å‰²ã€‚

æ³¨æ„ï¼šswagger.butler.ignore-routeså’Œ swagger.butler.generate-routesä¸èƒ½åŒæ—¶é…ç½®ã€‚è¿™ä¸¤ä¸ªå‚æ•°éƒ½ä¸é…ç½®çš„æ—¶å€™ï¼Œé»˜è®¤ä¸ºzuulä¸­çš„æ‰€æœ‰è·¯ç”±ç”Ÿæˆæ–‡æ¡£ã€‚

æŒ‡å®šæŸäº›è·¯ç”±ç”Ÿæˆ
# swagger resource

zuul
.
routes
.
user
.
path
=
/service-a/
**

zuul
.
routes
.
user
.
url
=
http
:
//localhost:10010/



# swagger resource

zuul
.
routes
.
product
.
path
=
/service-b/
**

zuul
.
routes
.
product
.
url
=
http
:
//localhost:10020/



# use zuul routes generate swagger resources

swagger
.
butler
.
auto
-
generate
-
from
-
zuul
-
routes
=
true

swagger
.
butler
.
generate
-
routes
=
product

å¦‚ä¸Šç¤ºä¾‹ï¼Œé€šè¿‡ swagger.butler.generate-routeså‚æ•°å¯ä»¥ä»å½“å‰é…ç½®çš„è·¯ç”±ä¿¡æ¯ä¸­æŒ‡å®šæŸäº›è·¯ç”±å†…å®¹ç”Ÿæˆæ–‡æ¡£ï¼Œé…ç½®å†…å®¹ä¸ºzuulä¸­çš„è·¯ç”±åç§°ï¼Œé…ç½®å¤šä¸ªçš„æ—¶å€™ä½¿ç”¨ ,åˆ†å‰²ã€‚

æ³¨æ„ï¼šswagger.butler.ignore-routeså’Œ swagger.butler.generate-routesä¸èƒ½åŒæ—¶é…ç½®ã€‚è¿™ä¸¤ä¸ªå‚æ•°éƒ½ä¸é…ç½®çš„æ—¶å€™ï¼Œé»˜è®¤ä¸ºzuulä¸­çš„æ‰€æœ‰è·¯ç”±ç”Ÿæˆæ–‡æ¡£ã€‚

ä¸æœåŠ¡æ²»ç†æ•´åˆ
ä¸eurekaæ•´åˆ
åœ¨æ•´åˆeurekaè·å–æ‰€æœ‰è¯¥æ³¨å†Œä¸­å¿ƒä¸‹çš„APIæ–‡æ¡£æ—¶ï¼Œåªéœ€è¦åœ¨ä¸Šé¢å·¥ç¨‹çš„åŸºç¡€ä¸Šå¢åŠ ä¸‹é¢çš„é…ç½®ï¼š

ç¬¬ä¸€æ­¥ï¼špom.xmlä¸­å¢åŠ  eurekaä¾èµ–ï¼Œæ¯”å¦‚ï¼š

<dependencies>


<dependency>


<groupId>
com.didispace
</groupId>


<artifactId>
swagger-butler-core
</artifactId>


<version>
2.0.0
</version>


</dependency>


<dependency>


<groupId>
org.springframework.cloud
</groupId>


<artifactId>
spring-cloud-starter-eureka
</artifactId>


<version>
2.0.0.RELEASE
</version>


</dependency>

</dependencies>

ç¬¬äºŒæ­¥ï¼šåº”ç”¨ä¸»ç±»å¢åŠ  @EnableDiscoveryClientï¼Œæ¯”å¦‚ï¼š

@EnableDiscoveryClient

@EnableSwaggerButler

@SpringBootApplication

public

class

EurekaApplication

{




public

static

void
 main
(
String
[]
 args
)

{


SpringApplication
.
run
(
EurekaApplication
.
class
);


}



}

ç¬¬ä¸‰æ­¥ï¼šä¿®æ”¹é…ç½®æ–‡ä»¶ï¼Œå¢åŠ eurekaçš„é…ç½®ï¼Œæ¯”å¦‚ï¼š

spring
.
application
.
name
=
swagger
-
butler
-
example
-
eureka

server
.
port
=
11001



eureka
.
client
.
service
-
url
.
defaultZone
=
http
:
//eureka.didispace.com/eureka/



swagger
.
butler
.
auto
-
generate
-
from
-
zuul
-
routes
=
true

swagger
.
butler
.
generate
-
routes
=
swagger
-
service
-
a
,
 swagger
-
service
-
b



swagger
.
butler
.
resources
.
swagger
-
service
-
b
.
api
-
docs
-
path
=
/xxx/
v2
/
api
-
docs

ç”±äºæ•´åˆäº†eurekaä¹‹åï¼Œzuulä¼šé»˜è®¤ä¸ºæ‰€æœ‰æ³¨å†ŒæœåŠ¡åˆ›å»ºè·¯ç”±é…ç½®ï¼ˆé»˜è®¤çš„è·¯ç”±åä¸ºæœåŠ¡åï¼‰ï¼Œæ‰€ä»¥åªéœ€è¦é€šè¿‡ swagger.butler.auto-generate-from-zuul-routes=trueå‚æ•°å¼€å¯æ ¹æ®è·¯ç”±ä¿¡æ¯ç”Ÿæˆæ–‡æ¡£é…ç½®çš„åŠŸèƒ½ï¼Œé…åˆ swagger.butler.ignore-routeså’Œ swagger.butler.generate-routeså‚æ•°å°±å¯ä»¥æŒ‡å®šè¦ç”Ÿæˆçš„èŒƒå›´äº†ï¼Œå¦‚æœæŸäº›æœåŠ¡éœ€è¦ç‰¹æ®Šé…ç½®ï¼Œä¹Ÿå¯ä»¥é€šè¿‡ wagger.butler.resources.*çš„é…ç½®æ¥è¦†ç›–é»˜è®¤è®¾ç½®ï¼Œæ¯”å¦‚ä¸Šé¢çš„ swagger.butler.resources.swagger-service-b.api-docs-path=/xxx/v2/api-docsæŒ‡å®šäº† swagger-service-bæœåŠ¡è·å–swaggeræ–‡æ¡£çš„è¯·æ±‚è·¯å¾„ä¸º /xxx/v2/api-docsã€‚

ä»£ç ç¤ºä¾‹å…·ä½“å¯è§ swagger-butler-example-eurekaç›®å½•

ä¸consulæ•´åˆ
åœ¨æ•´åˆeurekaè·å–æ‰€æœ‰è¯¥æ³¨å†Œä¸­å¿ƒä¸‹çš„APIæ–‡æ¡£æ—¶ï¼Œåªéœ€è¦åœ¨ä¸Šé¢å·¥ç¨‹çš„åŸºç¡€ä¸Šå¢åŠ ä¸‹é¢çš„é…ç½®ï¼š

ç¬¬ä¸€æ­¥ï¼špom.xmlä¸­å¢åŠ  consulä¾èµ–ï¼Œæ¯”å¦‚ï¼š

<dependencies>


<dependency>


<groupId>
com.didispace
</groupId>


<artifactId>
swagger-butler-core
</artifactId>


<version>
2.0.0
</version>


</dependency>


<dependency>


<groupId>
org.springframework.cloud
</groupId>


<artifactId>
spring-cloud-starter-consul-discovery
</artifactId>


<version>
2.0.0.RELEASE
</version>


</dependency>

</dependencies>

ç¬¬äºŒæ­¥ï¼šåº”ç”¨ä¸»ç±»å¢åŠ  @EnableDiscoveryClientï¼Œæ¯”å¦‚ï¼š

@EnableDiscoveryClient

@EnableSwaggerButler

@SpringBootApplication

public

class

EurekaApplication

{




public

static

void
 main
(
String
[]
 args
)

{


SpringApplication
.
run
(
EurekaApplication
.
class
);


}



}

ç¬¬ä¸‰æ­¥ï¼šé…ç½®æ–‡ä»¶ä¸­å¢åŠ eurekaçš„é…ç½®ï¼Œæ¯”å¦‚ï¼š

spring
.
application
.
name
=
swagger
-
butler
-
example
-
consul

server
.
port
=
11002



spring
.
cloud
.
consul
.
host
=
localhost

spring
.
cloud
.
consul
.
port
=
8500



swagger
.
butler
.
auto
-
generate
-
from
-
zuul
-
routes
=
true

swagger
.
butler
.
generate
-
routes
=
swagger
-
service
-
a
,
 swagger
-
service
-
b



swagger
.
butler
.
resources
.
swagger
-
service
-
b
.
api
-
docs
-
path
=
/xxx/
v2
/
api
-
docs

è¿™é‡Œé™¤äº†consulè‡ªèº«çš„é…ç½®ä¹‹å¤–ï¼Œå…¶ä»–å†…å®¹ä¸æ•´åˆeurekaæ—¶å€™çš„æ˜¯ä¸€æ ·çš„ã€‚

ä»£ç ç¤ºä¾‹å…·ä½“å¯è§ swagger-butler-example-consulç›®å½•
